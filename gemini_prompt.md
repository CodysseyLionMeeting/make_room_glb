# 3D Room Designer 프로젝트 - 기능 개선 아이디어 요청

## 📋 프로젝트 개요

저는 웹 기반 3D 방 인테리어 시뮬레이터를 개발했습니다. 사용자가 방 템플릿을 선택하고, 이미지를 업로드하여 바닥과 벽면 타일에 텍스처를 적용한 후, 완성된 3D 모델을 GLB 파일로 내보낼 수 있는 애플리케이션입니다.

**기술 스택:**
- Frontend: React + Three.js (React Three Fiber) + Vite
- Backend: FastAPI + OpenCV (Python)
- 3D Graphics: Three.js, GLTFExporter
- 배포: AWS EC2 (Ubuntu), Nginx

---

## 🎯 현재 구현된 핵심 기능

### 1. 방 템플릿 시스템 (7가지)

다양한 형태의 방 구조를 지원합니다:

| 템플릿 이름 | 크기 (m) | 특징 |
|------------|----------|------|
| 소형 스튜디오 | 2.5 × 3.0 | 최소 크기 원룸 |
| 일자형 원룸 | 3.0 × 4.0 | 기본 직사각형 구조 |
| 정사각형 원룸 | 4.0 × 4.0 | 정방형 구조 |
| 복도형 원룸 | 6.0 × 2.5 | 긴 복도 형태 |
| ㄱ자형 방 | 5.0 × 5.0 | L자 구조 (불규칙 영역) |
| ㄷ자형 원룸 | 5.0 × 5.0 | U자 구조 (중앙 비어있음) |
| 넓은 직사각형 | 5.0 × 4.0 | 대형 원룸 |

**구현 방식:**
- 각 템플릿은 `generateFloor()`와 `generateWalls()` 함수를 가짐
- 타일 크기: 0.5m × 0.5m (고정)
- 벽 높이: 2.5m (고정)
- 각 타일은 GLB 모델을 복제하여 생성

### 2. Seamless Texture 생성 (Backend - AI 알고리즘)

**Mirror Tiling 기법:**
```
사용자 이미지 업로드
    ↓
128×128로 리사이징
    ↓
4개 타일 생성:
┌────────┬────────┐
│ 원본   │ 좌우반전 │
├────────┼────────┤
│ 상하반전│ 180도회전│
└────────┴────────┘
    ↓
Gaussian Blur (seam blending)
    ↓
256×256 seamless texture
```

**핵심 알고리즘:**
- OpenCV의 `cv2.flip()` 및 `cv2.GaussianBlur()` 사용
- 중앙 수평/수직 seam에 5×5 커널 blur 적용
- JPEG 90% 품질로 압축
- Base64 Data URI 형식으로 전송

**효과:**
- 어떤 이미지도 타일처럼 반복해도 이음새가 보이지 않음
- 사용자가 수동으로 편집할 필요 없음

### 3. 타일 선택 및 텍스처 적용

**사용자 워크플로우:**
```
1. 타일 클릭 → 선택 (파란색 하이라이트)
2. 일괄 선택 버튼:
   - "바닥 전체 선택"
   - "앞/뒤/좌/우 벽 선택"
3. 이미지 갤러리에서 텍스처 선택
4. "적용" 버튼 클릭 → 선택된 타일에 텍스처 적용
```

**기술적 세부사항:**
- 클릭 vs 드래그 구분 (5px threshold)
- Three.js MeshStandardMaterial (PBR 물리 기반 렌더링)
- sRGB 색상 공간으로 텍스처 로드 (밝기 보정)
- 선택된 타일: 파란색 emissive glow

### 4. 조명 시스템

**3가지 조명 레이어:**

1. **Ambient Light (주변광)**
   - 범위: 0.0 ~ 1.0
   - 기본값: 0.3
   - 전체 장면의 기본 밝기

2. **Directional Light (방향광)**
   - 범위: 0.0 ~ 3.0
   - 기본값: 0.6
   - 위치: [5, 10, 7] (우상향)
   - 그림자 생성 (2048×2048 그림자 맵)

3. **Environment Map (HDRI)**
   - Preset: "city"
   - 강도: 0.15
   - 간접 조명 및 배경

**사용자 제어:**
- 슬라이더로 실시간 조명 조절
- 0.1 단위로 미세 조정 가능

### 5. GLB 내보내기 (핵심 알고리즘)

**복잡한 최적화 로직:**

#### Step 1: 타일 그룹화
```javascript
벽면별로 타일 분류:
- wall-front: 앞벽 타일들
- wall-back: 뒷벽 타일들
- wall-left: 왼쪽벽 타일들
- wall-right: 오른쪽벽 타일들
- floor: 바닥 타일들

각 그룹의 최소/최대 x, y 좌표 계산
```

#### Step 2: 텍스처 병합
```javascript
예시: 앞벽이 5×3 타일 (가로 5개, 세로 3개)
→ 2560×1536 픽셀 Canvas 생성 (512px × 5, 512px × 3)
→ 각 타일 이미지를 적절한 위치에 배치
→ Canvas를 JPEG 80%로 변환
→ 단일 병합 텍스처 생성
```

**효과:**
- 개별 타일 50개 → 병합 텍스처 5개
- GLB 파일 크기 대폭 감소
- 렌더링 성능 향상

#### Step 3: UV 좌표 재계산
```javascript
각 타일의 UV 좌표를 병합 텍스처 내 위치로 변환:

타일 (2, 1)의 UV:
  병합 텍스처 크기: 5×3
  UV 시작점: (2/5, 1/3) = (0.4, 0.333)
  UV 범위: (1/5, 1/3) = (0.2, 0.333)

  원래 UV (0~1) → (0.4~0.6, 0.333~0.666)
```

#### Step 4: GLB 파일 생성
```javascript
- GLTFExporter 사용
- Binary 모드 (glb 확장자)
- 텍스처 임베드 (embedImages: true)
- 파일명: room_[템플릿]_[타임스탬프].glb
```

### 6. UI/UX 기능

**좌측 컨트롤 패널:**
- 템플릿 선택 드롭다운 (접기/펼치기 애니메이션)
- 조명 강도 슬라이더 2개
- 깔끔한 카드 형태 디자인

**우측 사이드바:**
- 드래그로 너비 조절 가능 (200px ~ 500px)
- 이미지 업로드 버튼
- 업로드된 이미지 갤러리 (썸네일 그리드)
- 이미지별 삭제 버튼
- 일괄 선택 버튼 (바닥, 각 벽면)
- 적용 버튼 (선택된 타일에 텍스처 적용)
- GLB 내보내기 버튼

**3D 뷰어 조작:**
- 좌클릭 + 드래그: 카메라 회전
- 우클릭 + 드래그: 카메라 팬 이동
- 마우스 휠: 줌 인/아웃
- 줌 범위: 2m ~ 15m

### 7. 3D 렌더링 품질

**PBR (Physically Based Rendering):**
- MeshStandardMaterial 사용
- Roughness: 0.8 (약간 거친 표면)
- Metalness: 0.0 (비금속 재질)
- 양면 렌더링 (DoubleSide)

**그림자:**
- 모든 타일이 그림자 생성 및 수신
- 고해상도 그림자 맵 (2048×2048)

**성능 최적화:**
- 단일 GLB 모델 복제로 메모리 효율화
- useMemo로 불필요한 재렌더링 방지

---

## 🚀 데이터 흐름

```
[사용자] 이미지 업로드
    ↓
[Frontend] FormData로 전송
    ↓
[Backend] FastAPI 수신
    ↓
[OpenCV] Mirror tiling + Gaussian blur
    ↓
[Backend] Base64 Data URI 생성
    ↓
[Frontend] 이미지 갤러리에 추가
    ↓
[사용자] 타일 선택 + 이미지 선택 + 적용
    ↓
[Three.js] Texture 로드 및 Material 적용
    ↓
[사용자] GLB 내보내기 클릭
    ↓
[Frontend] 타일 그룹화 → 텍스처 병합 → UV 재계산
    ↓
[GLTFExporter] GLB 파일 생성
    ↓
[브라우저] 파일 다운로드
```

---

## ⚠️ 현재 제한사항 및 알려진 이슈

### 제한사항

1. **타일 크기 고정**: 0.5m로 고정되어 있어 더 세밀하거나 큰 타일 불가
2. **벽 높이 고정**: 2.5m로 고정
3. **방 크기 조정 불가**: 각 템플릿의 크기가 고정됨
4. **단일 프로젝트**: 여러 방을 저장하고 불러올 수 없음
5. **실행 취소 없음**: 잘못된 작업을 되돌릴 수 없음
6. **기본 텍스처 없음**: 매번 이미지를 업로드해야 함
7. **GLB만 지원**: OBJ, FBX 등 다른 포맷 미지원
8. **2D 평면도 없음**: 위에서 본 구조를 확인하기 어려움
9. **가구 배치 불가**: 빈 방만 생성 가능
10. **협업 기능 없음**: 혼자만 작업 가능

### 성능 이슈

- 큰 방 (예: 10m × 10m)의 경우 타일 개수가 400개 이상 → 브라우저 느려짐
- GLB 내보내기 시 대용량 텍스처 병합으로 메모리 사용량 증가

---

## 📊 기술적 세부사항

### Frontend 주요 라이브러리
```json
{
  "react": "^18.3.1",
  "three": "^0.171.0",
  "@react-three/fiber": "^8.18.5",
  "@react-three/drei": "^9.117.3"
}
```

### Backend 주요 라이브러리
```python
fastapi==0.121.3
uvicorn==0.38.0
opencv-python-headless==4.12.0.88
pillow==12.0.0
numpy==2.2.6
```

### 파일 구조
```
make_room_glb/
├── frontend/
│   ├── src/
│   │   └── RoomTest.jsx (1500+ lines)
│   ├── public/
│   │   └── tile.glb (기본 타일 모델)
│   └── package.json
├── backend/
│   ├── main.py (180 lines)
│   └── requirements.txt
└── deploy.sh (AWS EC2 배포 스크립트)
```

---

## 💡 질문

**당신이 AI 제품 기획자라고 가정해주세요.**

이 3D Room Designer 프로젝트를 분석하여, 다음을 제안해주세요:

### 1. 가장 우선적으로 추가해야 할 기능 5가지
   - 각 기능의 중요도 점수 (1-10)
   - 예상 구현 난이도 (쉬움/보통/어려움)
   - 사용자에게 제공하는 가치
   - 기술적 구현 방향 (간단한 설명)

### 2. 차별화 포인트를 만들 수 있는 혁신적인 기능 3가지
   - 경쟁 제품과 차별화할 수 있는 독창적인 아이디어
   - 기술적 실현 가능성

### 3. 현재 시스템의 개선점
   - 성능 최적화 방안
   - 코드 구조 개선 제안
   - UX/UI 개선 아이디어

### 4. 장기적 로드맵
   - 3개월, 6개월, 1년 단위로 발전시킬 방향
   - MVP → 베타 → 정식 출시 전략

### 5. 비즈니스 모델 아이디어
   - 수익화 방안
   - 타겟 사용자층 (B2C, B2B)
   - 마케팅 전략

---

## 🎨 참고: 유사 제품 분석

제가 알고 있는 유사 제품들:
- **Roomstyler 3D**: 웹 기반, 가구 배치 중심
- **Planner 5D**: 모바일/웹, 방 구조 그리기
- **SketchUp**: 전문가용, 복잡한 UI
- **HomeByMe**: Dassault Systèmes, 본격적인 인테리어 도구

**차별점:**
- 현재 프로젝트는 **텍스처 적용에 특화**
- Seamless texture 자동 생성 (AI 알고리즘)
- 간단한 UI로 **빠른 프로토타이핑** 가능

---

## 📝 추가 정보

- **배포 URL**: http://3.35.234.79 (AWS EC2)
- **GitHub**: https://github.com/CodysseyLionMeeting/make_room_glb
- **개발 기간**: 1주일
- **개발자**: 1명
- **목적**: 학교 프로젝트 / 포트폴리오

---

**당신의 창의적이고 실용적인 아이디어를 기대합니다!**
전문가의 시각에서 이 프로젝트를 한 단계 발전시킬 방법을 제시해주세요.
